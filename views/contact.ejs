<!DOCTYPE html>
<!--  Last updated: 02 Aug 2022  -->
<html lang="en" data-wf-page="61448a9f18708c14f2c5d52c">
  >
  <head>
    <%- include('includes/head') %> <%- include('includes/meta') %>
    <link href="https://www.specialisedsteering.com/contact" rel="canonical" />
    <script src="../js/block-scripts.js" defer></script>
    <%- include('includes/recaptcha-script') %>
    <script>
      // Set form load time for spam detection
      document.addEventListener("DOMContentLoaded", function () {
        const formLoadTimeInput = document.getElementById("formLoadTime");
        if (formLoadTimeInput) {
          formLoadTimeInput.value = Date.now();
        }
      });

      function validateContactForm() {
        const errors = [];
        const form = document.getElementById("contactForm");

        // Clear previous error states
        document
          .querySelectorAll(".input-error")
          .forEach(el => el.classList.remove("input-error"));

        // Validate required fields
        const name = document.getElementById("enquiryName");
        if (!name.value.trim()) {
          errors.push("Please enter your full name");
          name.classList.add("input-error");
        }

        const email = document.getElementById("enquiryEmail");
        if (!email.value.trim()) {
          errors.push("Please enter your email address");
          email.classList.add("input-error");
        } else if (!email.validity.valid) {
          errors.push("Please enter a valid email address");
          email.classList.add("input-error");
        }

        const phone = document.getElementById("enquiryNumber");
        if (!phone.value.trim()) {
          errors.push("Please enter your contact number");
          phone.classList.add("input-error");
        }

        const country = document.getElementById("contactCountry");
        if (!country.value) {
          errors.push("Please select your country");
          country.classList.add("input-error");
        }

        const message = document.getElementById("enquiryMessage");
        if (!message.value.trim()) {
          errors.push("Please tell us how we can help");
          message.classList.add("input-error");
        }

        const terms = document.getElementById("accept-terms");
        if (!terms.checked) {
          errors.push("Please accept the Terms & Conditions");
        }

        return errors;
      }

      function showErrors(errors) {
        const errorContainer = document.getElementById("form-errors");
        const errorList = document.getElementById("form-error-list");

        if (errors.length > 0) {
          errorList.innerHTML = errors.map(err => `<li>${err}</li>`).join("");
          errorContainer.classList.add("visible");
          errorContainer.scrollIntoView({
            behavior: "smooth",
            block: "nearest",
          });
          return false;
        } else {
          errorContainer.classList.remove("visible");
          return true;
        }
      }

      function onSubmit(token) {
        // Validate form
        const errors = validateContactForm();

        if (errors.length > 0) {
          showErrors(errors);
          grecaptcha.reset(); // Reset reCAPTCHA so user can try again
          return false;
        }

        // All validation passed - submit form
        const form = document.getElementById("contactForm");
        form.submit();
      }

      // Add real-time validation feedback
      document.addEventListener("DOMContentLoaded", function () {
        // Re-validate when Terms checkbox is changed
        const termsCheckbox = document.getElementById("accept-terms");
        if (termsCheckbox) {
          termsCheckbox.addEventListener("change", function () {
            const errorContainer = document.getElementById("form-errors");
            if (
              errorContainer &&
              errorContainer.classList.contains("visible")
            ) {
              // Re-run validation to update error list
              const errors = validateContactForm();
              showErrors(errors);
            }
          });
        }

        // Optional: Remove field-specific errors when user starts typing
        const requiredFields = [
          "enquiryName",
          "enquiryEmail",
          "enquiryNumber",
          "contactCountry",
          "enquiryMessage",
        ];
        requiredFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          if (field) {
            field.addEventListener("input", function () {
              // Remove red highlight when user starts fixing the field
              this.classList.remove("input-error");
            });
          }
        });
      });
    </script>
  </head>
  <body>
    <%- include('includes/analytics') %> <%- include('includes/nav') %>
    <main>
      <section id="contact-us" class="section main">
        <div class="container">
          <h1>Contact us - we're here to help!</h1>
          <div id="contact-form" class="form-block w-form">
            <h2>Get in Touch!</h2>
            <p>
              If you have a component for repair or you have any other query,
              reach out with as much info as necessary and we will be in touch
              within one business day.
            </p>
            <%- include('includes/forms/contact-form') %>
          </div>
        </div>
      </section>
    </main>
    <%- include('includes/footer') %> <%- include('includes/blockjs') %>
  </body>
</html>
