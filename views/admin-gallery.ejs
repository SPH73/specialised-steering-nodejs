<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('includes/meta') %> 
    <%- include('includes/head') %>
    <title>Admin - Gallery Management</title>
    <script src="../js/admin-gallery.js" defer></script>
  </head>
  <body>
    <%- include('includes/nav') %>
    <main>
      <section class="section">
        <div class="container">
          <h1>Gallery Management</h1>
          
          <div class="admin-gallery-controls">
            <div class="form-group">
              <label>
                <input type="checkbox" id="replaceMode" />
                Replace all existing gallery items (uncheck to append)
              </label>
            </div>
            
            <button id="updateGalleryBtn" class="button">
              Update Gallery from Google Photos
            </button>
          </div>
          
          <div class="picker-instructions" style="margin-top: 2rem; padding: 1rem; background: #f5f5f5; border-radius: 4px;">
            <h3 style="margin-top: 0;">How to use the Google Photos Picker:</h3>
            <ol style="margin-bottom: 0;">
              <li><strong>Use the search bar:</strong> Type the name of your album in the search bar at the top</li>
              <li><strong>Select photos:</strong> Once the album appears, click on photos to select them (up to 2000)</li>
              <li><strong>Click "Done":</strong> When finished selecting, click the "Done" button in the top right</li>
            </ol>
            <p style="margin-top: 1rem; margin-bottom: 0; font-size: 0.9em; color: #666;">
              <strong>Note:</strong> The Picker doesn't show an album list by default. You must search for the album name to find your photos. You can also drag and drop photos directly to upload new ones to Google Photos.
            </p>
            <p style="margin-top: 0.75rem; margin-bottom: 0; font-size: 0.9em; color: #d9534f;">
              <strong>⏱️ Time limit:</strong> You have approximately 30 seconds to select photos and click "Done". If you don't complete the selection within this time, the process will timeout and you'll need to start over.
            </p>
          </div>
          
          <div id="galleryStatus" class="gallery-status" style="display: none;">
            <p id="statusMessage"></p>
            <div id="statusProgress" style="display: none;">
              <p>Processing...</p>
            </div>
          </div>
          
          <div class="gallery-info">
            <p>Current gallery items: <span id="itemCount">-</span></p>
          </div>
        </div>
      </section>
    </main>
    <%- include('includes/footer') %> 
    <%- include('includes/blockjs') %>
    
    <script>
      // Pass Google Client ID to client-side script
      window.GOOGLE_CLIENT_ID = '<%= process.env.GOOGLE_CLIENT_ID || "" %>';
      window.ADMIN_API_BASE = '/admin/google/photos';
    </script>
  </body>
</html>

